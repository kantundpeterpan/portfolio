<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Do students describe professors differently based on gender? ‚Äì Heiner Atze, PhD</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Heiner Atze, PhD</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../embm/embm.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects.qmd"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-datacamp" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Datacamp</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-datacamp">    
        <li>
    <a class="dropdown-item" href="../../../datacamp/">
 <span class="dropdown-text">Guided</span></a>
  </li>  
        <li class="dropdown-header">Unguided</li>
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#scraping-the-web-for-reviews-of-professors" id="toc-scraping-the-web-for-reviews-of-professors" class="nav-link active" data-scroll-target="#scraping-the-web-for-reviews-of-professors">1. Scraping the web for reviews of professors</a>
  <ul class="collapse">
  <li><a href="#task-1a.-what-relevant-packages-do-we-need-for-web-scraping-and-reading-in-data" id="toc-task-1a.-what-relevant-packages-do-we-need-for-web-scraping-and-reading-in-data" class="nav-link" data-scroll-target="#task-1a.-what-relevant-packages-do-we-need-for-web-scraping-and-reading-in-data">Task 1a. What relevant packages do we need for web scraping and reading in data?</a></li>
  </ul></li>
  <li><a href="#used-to-parse-html" id="toc-used-to-parse-html" class="nav-link" data-scroll-target="#used-to-parse-html">Used to parse html</a></li>
  <li><a href="#used-to-pause-code-intermittently-so-that-our-scraper-is-not-blocked" id="toc-used-to-pause-code-intermittently-so-that-our-scraper-is-not-blocked" class="nav-link" data-scroll-target="#used-to-pause-code-intermittently-so-that-our-scraper-is-not-blocked">Used to pause code intermittently so that our scraper is not blocked</a></li>
  <li><a href="#for-data-manipulation-and-analysis" id="toc-for-data-manipulation-and-analysis" class="nav-link" data-scroll-target="#for-data-manipulation-and-analysis">For data manipulation and analysis</a></li>
  <li><a href="#to-access-our-data-filenames-so-we-can-read-them" id="toc-to-access-our-data-filenames-so-we-can-read-them" class="nav-link" data-scroll-target="#to-access-our-data-filenames-so-we-can-read-them">To access our data filenames so we can read them</a>
  <ul class="collapse">
  <li><a href="#task-1b.-which-professors-will-we-be-looking-at" id="toc-task-1b.-which-professors-will-we-be-looking-at" class="nav-link" data-scroll-target="#task-1b.-which-professors-will-we-be-looking-at">Task 1b. Which professors will we be looking at?</a></li>
  <li><a href="#task-1c.-how-can-we-use-urls-to-scrape-relevant-data-about-professors" id="toc-task-1c.-how-can-we-use-urls-to-scrape-relevant-data-about-professors" class="nav-link" data-scroll-target="#task-1c.-how-can-we-use-urls-to-scrape-relevant-data-about-professors">Task 1c. How can we use urls to scrape relevant data about professors?</a></li>
  </ul></li>
  <li><a href="#sample-code-to-loop-through-the-whole-list-of-professors" id="toc-sample-code-to-loop-through-the-whole-list-of-professors" class="nav-link" data-scroll-target="#sample-code-to-loop-through-the-whole-list-of-professors">1. Sample code to loop through the whole list of professors</a></li>
  <li><a href="#for-s-in-range40-lenprofs10" id="toc-for-s-in-range40-lenprofs10" class="nav-link" data-scroll-target="#for-s-in-range40-lenprofs10">for s in (range(40, len(profs),10)):</a></li>
  <li><a href="#sample-code-to-loop-through-the-first-10-professors" id="toc-sample-code-to-loop-through-the-first-10-professors" class="nav-link" data-scroll-target="#sample-code-to-loop-through-the-first-10-professors">2. Sample code to loop through the first 10 professors</a></li>
  <li><a href="#reading-pre-scraped-data" id="toc-reading-pre-scraped-data" class="nav-link" data-scroll-target="#reading-pre-scraped-data">2. Reading pre-scraped data</a>
  <ul class="collapse">
  <li><a href="#task-2a.-how-can-we-read-a-directory-of-scraped-professor-reviews-and-concatenate-them" id="toc-task-2a.-how-can-we-read-a-directory-of-scraped-professor-reviews-and-concatenate-them" class="nav-link" data-scroll-target="#task-2a.-how-can-we-read-a-directory-of-scraped-professor-reviews-and-concatenate-them">Task 2a. How can we read a directory of scraped professor reviews and concatenate them?</a></li>
  <li><a href="#task-2b.-what-does-the-final-shape-of-our-dataframe-look-like" id="toc-task-2b.-what-does-the-final-shape-of-our-dataframe-look-like" class="nav-link" data-scroll-target="#task-2b.-what-does-the-final-shape-of-our-dataframe-look-like">Task 2b. What does the final shape of our DataFrame look like?</a></li>
  </ul></li>
  <li><a href="#text-analysis" id="toc-text-analysis" class="nav-link" data-scroll-target="#text-analysis">3. Text Analysis</a>
  <ul class="collapse">
  <li><a href="#a.-what-additional-package-imports-are-required-for-data-visualization-and-nlp" id="toc-a.-what-additional-package-imports-are-required-for-data-visualization-and-nlp" class="nav-link" data-scroll-target="#a.-what-additional-package-imports-are-required-for-data-visualization-and-nlp">3a. What additional package imports are required for data visualization and NLP?</a></li>
  </ul></li>
  <li><a href="#for-plotting" id="toc-for-plotting" class="nav-link" data-scroll-target="#for-plotting">For plotting</a>
  <ul class="collapse">
  <li><a href="#b.-how-can-we-assign-gender-labels-to-professors" id="toc-b.-how-can-we-assign-gender-labels-to-professors" class="nav-link" data-scroll-target="#b.-how-can-we-assign-gender-labels-to-professors">3b. How can we assign gender labels to professors?</a></li>
  <li><a href="#c.-are-there-any-initial-differences-between-male-and-female-professors-based-on-their-overall-ratings" id="toc-c.-are-there-any-initial-differences-between-male-and-female-professors-based-on-their-overall-ratings" class="nav-link" data-scroll-target="#c.-are-there-any-initial-differences-between-male-and-female-professors-based-on-their-overall-ratings">3c. Are there any initial differences between male and female professors based on their overall ratings?</a></li>
  <li><a href="#task-3d.-what-are-the-most-important-words-being-used-to-describe-professors-in-reviews" id="toc-task-3d.-what-are-the-most-important-words-being-used-to-describe-professors-in-reviews" class="nav-link" data-scroll-target="#task-3d.-what-are-the-most-important-words-being-used-to-describe-professors-in-reviews">Task 3d. What are the most important words being used to describe professors in reviews?</a></li>
  <li><a href="#congratulations-on-making-it-to-the-end-where-to-from-here--we-can-feed-these-words-into-ben-schmidts-tool-to-derive-insights-by-field.--if-youre-interested-in-learning-more-about-web-scraping-take-our-courses-on-web-scraping-in-python--if-youre-intersted-in-diving-in-to-the-world-of-natural-language-processing-explore-our-skill-track." id="toc-congratulations-on-making-it-to-the-end-where-to-from-here--we-can-feed-these-words-into-ben-schmidts-tool-to-derive-insights-by-field.--if-youre-interested-in-learning-more-about-web-scraping-take-our-courses-on-web-scraping-in-python--if-youre-intersted-in-diving-in-to-the-world-of-natural-language-processing-explore-our-skill-track." class="nav-link" data-scroll-target="#congratulations-on-making-it-to-the-end-where-to-from-here--we-can-feed-these-words-into-ben-schmidts-tool-to-derive-insights-by-field.--if-youre-interested-in-learning-more-about-web-scraping-take-our-courses-on-web-scraping-in-python--if-youre-intersted-in-diving-in-to-the-world-of-natural-language-processing-explore-our-skill-track.">Congratulations on making it to the end! ### Where to from here?- We can feed these words into Ben Schmidt‚Äôs tool to derive insights by field.- If you‚Äôre interested in learning more about web scraping, take our courses on Web Scraping in Python- If you‚Äôre intersted in diving in to the world of Natural Language Processing, explore our skill track.</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Do students describe professors differently based on gender?</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Language plays a crucial role in shaping our perceptions and attitudes towards gender in the workplace, in classrooms, and personal relationships. Studies have shown that gender bias in language can have a significant impact on the way people are perceived and treated. For example, research has found that job advertisements that use masculine-coded language tend to attract more male applicants, while those that use feminine-coded language tend to attract more female applicants. Similarly, gendered language can perpetuate differences in the classroom.In this project, we‚Äôll using scraped student reviews from <a href="https://ratemyprofessors.com">ratemyprofessors.com</a> to identify differences in language commonly used for male vs.&nbsp;female professors, and explore subtleties in how language in the classroom can be gendered.This excellent <a href="https://benschmidt.org/profGender/#%7B%22database%22%3A%22RMP%22%2C%22plotType%22%3A%22pointchart%22%2C%22method%22%3A%22return_json%22%2C%22search_limits%22%3A%7B%22word%22%3A%5B%22aggressive%22%5D%2C%22department__id%22%3A%7B%22%24lte%22%3A25%7D%2C%22rHelpful%22%3A%5B1%2C2%5D%2C%22rClarity%22%3A%5B1%2C2%5D%7D%2C%22aesthetic%22%3A%7B%22x%22%3A%22WordsPerMillion%22%2C%22y%22%3A%22department%22%2C%22color%22%3A%22gender%22%7D%2C%22counttype%22%3A%5B%22WordsPerMillion%22%5D%2C%22groups%22%3A%5B%22department%22%2C%22gender%22%5D%2C%22testGroup%22%3A%22C%22%7D">tool</a> created by Ben Schmidt allows us to enter the words and phrases that we find in our analysis and explore them in more depth. We‚Äôll do this at the end.Catalyst also does some incredible work on <a href="https://www.catalyst.org/2015/05/07/can-you-spot-the-gender-bias-in-this-job-description/">decoding</a> gendered language.</p>
<section id="scraping-the-web-for-reviews-of-professors" class="level1">
<h1>1. Scraping the web for reviews of professors</h1>
<p>Text data‚Äì‚Äìespecially gendered text data, is hard to come by. Web scraping can be a helpful data collection tool when datasets are unable for this kind of work. We can write web scrapers to compile datasets on job descriptions, freelancer reviews, and, as in our use-case, professor reviews by students.<a href="https://www.ratemyprofessors.com/professor?tid=589">ratemyprofessors.com</a> provides an insightful combination of qualitative and quantitative metrics that we can analyze.Although the data on their websites is not labeled by gender, we‚Äôll use pronouns used by students to label professors ‚ÄúMale‚Äù or ‚ÄúFemale‚Äù. Of course, this approach is not perfect, as it relies on the <em>students‚Äô</em> use of pronouns. Professors with non-binary pronouns will also be under-represented in the data, since very few reviews will have them, and so it‚Äôs not trivial to write an algorithm to detect them. These are definitely important questions in the world of gender analysis though, so we encourage you to pick them up as extensions of this project!</p>
<section id="task-1a.-what-relevant-packages-do-we-need-for-web-scraping-and-reading-in-data" class="level3">
<h3 class="anchored" data-anchor-id="task-1a.-what-relevant-packages-do-we-need-for-web-scraping-and-reading-in-data">Task 1a. What relevant packages do we need for web scraping and reading in data?</h3>
<p>::: {#5d32b671-a5a9-4b1c-b730-dbd276406a93 .cell jupyter=‚Äò{‚Äúoutputs_hidden‚Äù:false,‚Äúsource_hidden‚Äù:false}‚Äô executionTime=‚Äò3473‚Äô lastSuccessfullyExecutedCode=‚Äô# Used to open urls from urllib.request import urlopen</p>
</section>
</section>
<section id="used-to-parse-html" class="level1">
<h1>Used to parse html</h1>
<p>from lxml import etree</p>
</section>
<section id="used-to-pause-code-intermittently-so-that-our-scraper-is-not-blocked" class="level1">
<h1>Used to pause code intermittently so that our scraper is not blocked</h1>
<p>import time</p>
</section>
<section id="for-data-manipulation-and-analysis" class="level1">
<h1>For data manipulation and analysis</h1>
<p>import pandas as pd</p>
</section>
<section id="to-access-our-data-filenames-so-we-can-read-them" class="level1">
<h1>To access our data filenames so we can read them</h1>
<p>import os‚Äô executionCancelledAt=‚Äònull‚Äô lastExecutedAt=‚Äò1719739817521‚Äô lastExecutedByKernel=‚Äò9896dc8c-d55f-4b46-9684-fd55c8f98cab‚Äô lastScheduledRunId=‚Äònull‚Äô execution_count=1}</p>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Used to open urlsfrom urllib.request import urlopen# Used to parse htmlfrom lxml import etree# Used to pause code intermittently so that our scraper is not blockedimport time# For data manipulation and analysisimport pandas as pd# To access our data filenames so we can read themimport os</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<section id="task-1b.-which-professors-will-we-be-looking-at" class="level3">
<h3 class="anchored" data-anchor-id="task-1b.-which-professors-will-we-be-looking-at">Task 1b. Which professors will we be looking at?</h3>
<p>The <code>web_scraping.ipynb</code> notebook provided in this workspace provides some code using selenium that was used to find urls from <a href="https://ratemyprofessors.com">ratemyprofessors.com</a> that we‚Äôll be scraping in this notebook.Whilst the specific selenium code used to generate this list of URLs is beyond what we can cover today, we encourage you to explore this code to understand how we generated this list of professors!For now, we‚Äôll open the file <code>profs_888.txt</code> and read each professor‚Äôs url in a new line, and save this variable as <code>profs</code>.</p>
<div id="83b8efe1-4c75-4755-9534-a8889b82c6d6" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="267" data-lastsuccessfullyexecutedcode="with open(r'profs_1244.txt', 'r') as f:     profs = [i.strip() for i in f.readlines()]" data-executioncancelledat="null" data-lastexecutedat="1719739817790" data-lastexecutedbykernel="9896dc8c-d55f-4b46-9684-fd55c8f98cab" data-lastscheduledrunid="null" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="vs">r'profs_1244.txt'</span>, <span class="st">'r'</span>) <span class="im">as</span> f:    profs <span class="op">=</span> [i.strip() <span class="cf">for</span> i <span class="kw">in</span> f.readlines()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-1c.-how-can-we-use-urls-to-scrape-relevant-data-about-professors" class="level3">
<h3 class="anchored" data-anchor-id="task-1c.-how-can-we-use-urls-to-scrape-relevant-data-about-professors">Task 1c. How can we use urls to scrape relevant data about professors?</h3>
<p>Each professor has an overall rating that looks like this<img src="img/overall_rating_example.png" width="400">and a series of reviews that look like this<img src="img/review_example.png" class="img-fluid" alt="Review example">The code below can be used to iterate through all or part of the list of urls in <code>profs</code>, and scrape them for qualtiative and quantitative data. <strong>You won‚Äôt need to run through this whole list though, because the <code>data/</code> folder already contains the reviews of several professors that we have scraped for you!</strong>- The overall rating for the professor- All the individual reviews written by students about the professor- The ‚Äúemotion‚Äù corresponding to each individual review: <code>üòé AWESOME</code>, <code>üòê AVERAGE</code>, or <code>üòñ AWFUL</code>- A numerical ‚Äúquality‚Äù rating corresponding to each individual reviewWe won‚Äôt be using the ‚Äúdifficulty‚Äù ratings shown here.</p>
<p>::: {#432d6789-8153-4de1-baae-ae211ca49c23 .cell jupyter=‚Äò{‚Äúoutputs_hidden‚Äù:false,‚Äúsource_hidden‚Äù:false}‚Äô executionTime=‚Äò93403‚Äô lastSuccessfullyExecutedCode=‚Äô# USE ONLY ONE OF THE FOLLOWING FOR STATEMENTS</p>
</section>
</section>
<section id="sample-code-to-loop-through-the-whole-list-of-professors" class="level1">
<h1>1. Sample code to loop through the whole list of professors</h1>
</section>
<section id="for-s-in-range40-lenprofs10" class="level1">
<h1>for s in (range(40, len(profs),10)):</h1>
</section>
<section id="sample-code-to-loop-through-the-first-10-professors" class="level1">
<h1>2. Sample code to loop through the first 10 professors</h1>
<p>for s in (range(0, 10, 10)):</p>
<pre><code>texts = [] # Initialzie an empty array
print((s, s+10)) # Iterate through 10 professors at a time

for url in profs[s:s+10]: # Iterate through this block
    time.sleep(8) # To prevent sending too many requests at once
    r = urlopen(url) # Open URL
    htmlparser = etree.HTMLParser() # Instantiate a parser to parse HTML
    tree = etree.parse(r, htmlparser) # Parse HTML returned by the url
    
    text = tree.xpath(\'//*[@id="ratingsList"]/li[*]/div/div/div[3]/div[3]/text()\') # Extract reviews
    ratings = tree.xpath(\'//*[@id="root"]/div/div/div[3]/div[2]/div[1]/div[1]/div[1]/div/div[1]\') # Extract ratings
    emotion = tree.xpath(\'//*[@id="ratingsList"]/li[*]/div/div/div[1]/div[1]/div[2]/text()\') # Extract emotion
    quality = tree.xpath(\'//*[@id="ratingsList"]/li[*]/div/div/div[2]/div[1]/div/div[2]\') # Extract quality
    texts.append((url,
                  text,
                  [i.text for i in ratings][0],
                  emotion,
                  [i.text for i in quality],
                 )) # Append metrics to empty list

print() # Print new line for readability
df = pd.DataFrame(texts, columns = [\'prof\',\'review\', \'rating\',\'emotion\',\'quality\']) # Create DataFrame from texts
df.to_csv(f\'df_{s}_to_{s+10}.csv\') # Write result to df in blocks of 10 professors at a time
time.sleep(10) # Pause to prevent sending too many requests at once' executionCancelledAt='null' lastExecutedAt='1719739922919' lastExecutedByKernel='9896dc8c-d55f-4b46-9684-fd55c8f98cab' lastScheduledRunId='null' outputsMetadata='{"0":{"height":59,"type":"stream"}}' execution_count=3}</code></pre>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># USE ONLY ONE OF THE FOLLOWING FOR STATEMENTS# 1. Sample code to loop through the whole list of professors    # for s in (range(40, len(profs),10)):# 2. Sample code to loop through the first 10 professorsfor s in (range(0, 10, 10)):    texts = [] # Initialzie an empty array    print((s, s+10)) # Iterate through 10 professors at a time        for url in profs[s:s+10]: # Iterate through this block        time.sleep(8) # To prevent sending too many requests at once        r = urlopen(url) # Open URL        htmlparser = etree.HTMLParser() # Instantiate a parser to parse HTML        tree = etree.parse(r, htmlparser) # Parse HTML returned by the url                text = tree.xpath('//*[@id="ratingsList"]/li[*]/div/div/div[3]/div[3]/text()') # Extract reviews        ratings = tree.xpath('//*[@id="root"]/div/div/div[3]/div[2]/div[1]/div[1]/div[1]/div/div[1]') # Extract ratings        emotion = tree.xpath('//*[@id="ratingsList"]/li[*]/div/div/div[1]/div[1]/div[2]/text()') # Extract emotion        quality = tree.xpath('//*[@id="ratingsList"]/li[*]/div/div/div[2]/div[1]/div/div[2]') # Extract quality        texts.append((url,                      text,                      [i.text for i in ratings][0],                      emotion,                      [i.text for i in quality],                     )) # Append metrics to empty list    print() # Print new line for readability    df = pd.DataFrame(texts, columns = ['prof','review', 'rating','emotion','quality']) # Create DataFrame from texts    df.to_csv(f'df_{s}_to_{s+10}.csv') # Write result to df in blocks of 10 professors at a time    time.sleep(10) # Pause to prevent sending too many requests at once</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0, 10)
</code></pre>
</div>
<p>:::</p>
<div id="9369fc3b-ca14-4467-bfff-1f20c1d00380" class="cell" data-executioncancelledat="null" data-executiontime="13" data-lastexecutedat="1718744332893" data-lastexecutedbykernel="5d1eba1f-553e-4049-8b86-b3afee92765f" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="text" data-execution_count="9">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>text</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>['Tests are way too hard for a course that should be straight forward. Ive taken exams in the past that were worth 300 points, but thats the entire class grade. 3 exams, 100 points each, thats it. Mainly based on Essay Questions and 25 multiple choice. Avoid if you can. If you have to take this class just make sure you dont take it lightly.',
 "Professor Kobak is very passionate about developmental psychology and it is evident in his lectures. His lectures are insanely boring. They seriously seem eternal, but he does not put his full slides online so it is good to go. Also he has clicker questions he uses for extra credit. If you don't read you will not get an A.",
 'The classes were boring, the exams were impossible, and I struggled for my C.',
 "This class shouldn't be as hard as it is made. Exams are confusing and a few questions were incomprehensible on each one. To make it worse, no specifics are given as to what will be on the exam, just how many questions from each chapter will be on it.  If you have the time to do every single reading you can do well, but you won't be able to cruise.",
 'Dull, confusing, and vague. You will never know where the exam material is coming from. AVOID this professor...has no idea how a good psych class is taught. Easy B nothing more',
 'AWFUL, BORING, puts you to sleep, tests are confusing',
 'nice professor but the class gets really boring. uses powerpoints in class and there are 3 tests which constitute your whole grade. tests are pretty tricky, you need to study at least a couple nights in advance for them and even then you might still just get a B',
 "Grade based off of 3 Multiple Choice tests (50 questions on each). No rounding or extra credit but its an interesting class. Dr. Kobak is a cool dude. If you're a psyc or human services major the tests will be obvious. Regardless, it's a totally fair class. Take it!",
 "Kobak is a really nice guy! Classes seem pointless but his test questions come directly form the powerpoint! Don't need the textbook at all but you have to study for the tests. Go to class and study the material and you will definitely get at least a B.",
 'This professor is adorable, and really funny. There was a lot of reading for each class, and he uses slides and would put them online before class. He shows a lot of good movie clips. Only 3 tests all semester and they were all multiple choice. There was a lot of material to cover, but it was an interesting class.',
 "Very nice guy. Very helpful during office hours. It wasn't totally necessary to read the book, but I would at least read the summaries. Some MC questions are directly from readings. The most difficult part of the tests were the essays, and he was usually quite explicit about his expectations for them when reviewing the material prior to the test.",
 'Nice guy, fine teacher. Got bored and distracted every once in a while, but I still got an A. If you are good at Psych, you will do fine.',
 "This class overall was a good experience. However your grade is based on 3 tests (all multiple choice). Even though he does posts power points he DOES NOT include all the slides given in class.  So it's smart to attend class.  Plus he gives questions that appear on the test and he doesn't post those either.  Overall, a good professor.",
 "I thought that this was a good class. Helps if you have some interest in child development. No extra assignments or papers, just three exams. Fantastic if you don't want to have to do much work throughout the semester, bad if you don't take tests well. Essays count for a lot on the test so if you can write clearly, you'll probably do well.",
 'Enjoyable class! Posts powerpoints, Attending class helps on exams.',
 "great guy. he means well. slides are great and he posts them online after classes. if you do go to classes he'll give you sample mutliple choice questions that actually appear on the exams. sometimes questions on exams are hard to understand though. definitely do the extra credit!",
 'Slides are all over the place. to study you need to read which is a pain because his notes jump from chapter 1 to 14 without even clarifying. doesnt help at all when asked. dont recommend taking him',
 'Extremely long powerpoints but will e-mail slides to class after presentation. Nice man, however seems somewhat aloof as most of his slides are disorganized and directly from the text. Class is important for learning exam material, but can do well just by reading the book. Do the extra credit and read the material- it would be hard not to pass.',
 'Kobak is a very friendly, light-hearted guy who knows his stuff. Plenty of short films to make class enjoyable. 3 tests plus 10 possible pt. extra credit. Do the extra credit, you\'re almost guarenteed perfect credit. A "B" is definitely attainable if you put in some effort. I recommend him.',
 'No Comments']</code></pre>
</div>
</div>
</section>
<section id="reading-pre-scraped-data" class="level1">
<h1>2. Reading pre-scraped data</h1>
<section id="task-2a.-how-can-we-read-a-directory-of-scraped-professor-reviews-and-concatenate-them" class="level3">
<h3 class="anchored" data-anchor-id="task-2a.-how-can-we-read-a-directory-of-scraped-professor-reviews-and-concatenate-them">Task 2a. How can we read a directory of scraped professor reviews and concatenate them?</h3>
<p>Since we have already scraped reviews from several professors for you, let‚Äôs begin by concatenating all the files in the <code>data</code> folder provided. These have already been scraped for you.Since <code>review</code>, <code>emotion</code> and <code>quality</code> are lists but were recorded in string form, we‚Äôll apply <code>eval()</code> to them to turn them back from a string into a list.</p>
<div id="8d0eb371-f339-4c0a-b3e2-0a5840af2706" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="308" data-lastsuccessfullyexecutedcode="df = pd.concat([pd.read_csv('data/'+i,                             index_col=0) for i in os.listdir('data')]).reset_index(drop=True) df['review'] = df['review'].apply(lambda x: eval(x)) df['emotion'] = df['emotion'].apply(lambda x: eval(x)) df['quality'] = df['quality'].apply(lambda x: eval(x))" data-executioncancelledat="null" data-lastexecutedat="1719740175772" data-lastexecutedbykernel="9896dc8c-d55f-4b46-9684-fd55c8f98cab" data-lastscheduledrunid="null" data-execution_count="11">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([pd.read_csv(<span class="st">'data/'</span><span class="op">+</span>i,                            index_col<span class="op">=</span><span class="dv">0</span>) <span class="cf">for</span> i <span class="kw">in</span> os.listdir(<span class="st">'data'</span>)]).reset_index(drop<span class="op">=</span><span class="va">True</span>)df[<span class="st">'review'</span>] <span class="op">=</span> df[<span class="st">'review'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">eval</span>(x))df[<span class="st">'emotion'</span>] <span class="op">=</span> df[<span class="st">'emotion'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">eval</span>(x))df[<span class="st">'quality'</span>] <span class="op">=</span> df[<span class="st">'quality'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">eval</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-2b.-what-does-the-final-shape-of-our-dataframe-look-like" class="level3">
<h3 class="anchored" data-anchor-id="task-2b.-what-does-the-final-shape-of-our-dataframe-look-like">Task 2b. What does the final shape of our DataFrame look like?</h3>
<p>Browse the <code>df</code> below to familiarize yourself with the dataset we‚Äôll be working with. The DataFrame contains one row for each professor, containing:- Their url- All the raw text reviews for that professor- Their overall rating- All the emotion labels associated with reviews of that professor- All quality ratings assigned to that professor</p>
<div id="33dbb820-d76a-4607-96f3-0ff3859c0e6b" class="cell" data-executiontime="4703" data-lastsuccessfullyexecutedcode="df" data-outputsmetadata="{&quot;0&quot;:{&quot;height&quot;:321,&quot;type&quot;:&quot;dataFrame&quot;}}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prof</th>
<th data-quarto-table-cell-role="th">review</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">emotion</th>
<th data-quarto-table-cell-role="th">quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[The Best Professor at Kettering. Just rememb...</td>
<td>4.6</td>
<td>[awesome, awesome, awesome, awesome, awesome, ...</td>
<td>[5.0, 4.0, 5.0, 4.5, 5.0, 4.5, 2.5, 5.0, 5.0, ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[Awesome prof! He picks really great course ma...</td>
<td>4.2</td>
<td>[awesome, awesome, awesome, awesome, awesome, ...</td>
<td>[4.5, 4.5, 4.5, 5.0, 4.0, 3.0, 5.0, 2.0, 3.0, ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[He is a macho guy. I ilke him while he talks ...</td>
<td>3.6</td>
<td>[awesome, awesome, awesome, awesome, average, ...</td>
<td>[4.0, 5.0, 4.5, 4.5, 3.5, 5.0, 1.5, 4.5, 1.5, ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[I love Dr. Barker! His lectures are interesti...</td>
<td>3.0</td>
<td>[awesome, average, awful, awful, awful, awful,...</td>
<td>[5.0, 3.0, 2.5, 2.0, 2.5, 2.5, 3.5, 2.0, 5.0, ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[i hate this stupid man he sucks and he's a ho...</td>
<td>2.8</td>
<td>[awful, awful, awful, awful, awful, awful, awf...</td>
<td>[1.0, 1.0, 1.5, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">575</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[Connait tr√É∆í√Ç¬®s bien sa mati√É∆í√Ç¬®re. Le cours ...</td>
<td>3.5</td>
<td>[awesome, awful, awesome, awful, awesome, awes...</td>
<td>[4.0, 2.0, 4.0, 1.5, 5.0, 5.0, 4.5, 1.0, 4.5, ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">576</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[Really knowledgeable guy, I learned a lot., N...</td>
<td>2.8</td>
<td>[awesome, awful, average, awful, awful, averag...</td>
<td>[5.0, 2.0, 3.0, 1.0, 1.0, 3.0, 4.5, 5.0, 5.0, ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">577</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[Love good ol' Carmichael. Sadly, he is retiri...</td>
<td>3.8</td>
<td>[awesome, average, average, awesome, awesome, ...</td>
<td>[5.0, 3.0, 3.0, 5.0, 5.0, 4.0, 5.0, 4.0, 5.0, ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">578</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[Mike is easily the best ENGL prof I've had (a...</td>
<td>4.4</td>
<td>[awesome, awesome, awesome, awesome, awesome, ...</td>
<td>[5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 4.5, ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">579</td>
<td>https://www.ratemyprofessors.com/professor?tid...</td>
<td>[In Mr. Ellul's class, students should have kn...</td>
<td>2.5</td>
<td>[awesome, awesome, awesome, awesome, awesome, ...</td>
<td>[4.5, 4.5, 4.5, 5.0, 5.0, 2.0, 1.0, 1.0, 2.5, ...</td>
</tr>
</tbody>
</table>

<p>580 rows √ó 5 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="text-analysis" class="level1">
<h1>3. Text Analysis</h1>
<section id="a.-what-additional-package-imports-are-required-for-data-visualization-and-nlp" class="level2">
<h2 class="anchored" data-anchor-id="a.-what-additional-package-imports-are-required-for-data-visualization-and-nlp">3a. What additional package imports are required for data visualization and NLP?</h2>
<p>::: {#8d6a7a01-887d-4df1-98b6-5a3c95e35519 .cell jupyter=‚Äò{‚Äúoutputs_hidden‚Äù:false,‚Äúsource_hidden‚Äù:false}‚Äô executionTime=‚Äò841‚Äô lastSuccessfullyExecutedCode=‚Äôimport numpy as np # For manipulating matrices during NLP</p>
<p>import nltk # Natural language toolkit from nltk.tokenize import word_tokenize # Used for breaking up strings of text (e.g.&nbsp;sentences) into words from nltk.stem.porter import PorterStemmer # Used to return the dictionary base of a word from nltk.tokenize import WhitespaceTokenizer # Used for breaking up strings of text (e.g.&nbsp;sentences) into words based on white space</p>
<p>nltk.download('punkt')</p>
<p>from sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer # Used to count the occurences of words and phrases from sklearn.feature_extraction import text # Using to extrat features from text</p>
</section>
</section>
<section id="for-plotting" class="level1">
<h1>For plotting</h1>
<p>import matplotlib.pyplot as plt import seaborn as sns sns.set(style='white')‚Äô outputsMetadata=‚Äò{‚Äú0‚Äù:{‚Äúheight‚Äù:59,‚Äútype‚Äù:‚Äústream‚Äù}}‚Äô executionCancelledAt=‚Äònull‚Äô lastExecutedAt=‚Äò1719740146111‚Äô lastExecutedByKernel=‚Äò9896dc8c-d55f-4b46-9684-fd55c8f98cab‚Äô lastScheduledRunId=‚Äònull‚Äô execution_count=8}</p>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># For manipulating matrices during NLPimport nltk # Natural language toolkitfrom nltk.tokenize import word_tokenize # Used for breaking up strings of text (e.g. sentences) into wordsfrom nltk.stem.porter import PorterStemmer # Used to return the dictionary base of a wordfrom nltk.tokenize import WhitespaceTokenizer # Used for breaking up strings of text (e.g. sentences) into words based on white spacenltk.download('punkt')from sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer # Used to count the occurences of words and phrasesfrom sklearn.feature_extraction import text # Using to extrat features from text# For plottingimport matplotlib.pyplot as plt import seaborn as snssns.set(style='white')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[nltk_data] Downloading package punkt to /home/repl/nltk_data...
[nltk_data]   Package punkt is already up-to-date!</code></pre>
</div>
<p>:::</p>
<section id="b.-how-can-we-assign-gender-labels-to-professors" class="level3">
<h3 class="anchored" data-anchor-id="b.-how-can-we-assign-gender-labels-to-professors">3b. How can we assign gender labels to professors?</h3>
<p>Let‚Äôs write a custom function that assigns a gender label to professors based on the pronouns most commontly used for him. Specifically:- If any of <code>['she', 'her', 'herself', 'shes']</code> occur more than 5 times across all reviews for that professor, we label the professor ‚ÄúF‚Äù.- If any of <code>['him', 'he', 'his', 'himself']</code> occur more than 5 times across all reviews for that professor, we label the professor ‚ÄúF‚Äù.</p>
<div id="b44c0b61-91e6-4a2e-b969-8e12d9dca25e" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="12" data-lastsuccessfullyexecutedcode="def assign_pronoun(review_list):     reviews = ' '.join([str(i) for i in review_list])     tokens = word_tokenize(reviews.lower())     if sum([i in ['she', 'her', 'herself', 'shes'] for i in tokens]) > 5:         return 'F'     elif sum([i in ['him', 'he', 'his', 'himself'] for i in tokens]) > 5:         return 'M'" data-executioncancelledat="null" data-lastexecutedat="1719740123208" data-lastexecutedbykernel="9896dc8c-d55f-4b46-9684-fd55c8f98cab" data-lastscheduledrunid="null" data-execution_count="6">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_pronoun(review_list):    reviews <span class="op">=</span> <span class="st">' '</span>.join([<span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> review_list])    tokens <span class="op">=</span> word_tokenize(reviews.lower())    <span class="cf">if</span> <span class="bu">sum</span>([i <span class="kw">in</span> [<span class="st">'she'</span>, <span class="st">'her'</span>, <span class="st">'herself'</span>, <span class="st">'shes'</span>] <span class="cf">for</span> i <span class="kw">in</span> tokens]) <span class="op">&gt;</span> <span class="dv">5</span>:        <span class="cf">return</span> <span class="st">'F'</span>    <span class="cf">elif</span> <span class="bu">sum</span>([i <span class="kw">in</span> [<span class="st">'him'</span>, <span class="st">'he'</span>, <span class="st">'his'</span>, <span class="st">'himself'</span>] <span class="cf">for</span> i <span class="kw">in</span> tokens]) <span class="op">&gt;</span> <span class="dv">5</span>:        <span class="cf">return</span> <span class="st">'M'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We‚Äôll now assign the pronouns. We‚Äôll also split review texts into individual ‚Äútokens‚Äù, by calling <code>word_tokenize()</code> from <code>nltk</code>.</p>
<div id="ceafc103-6ee0-4d16-a61c-aadbf489900c" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="2799" data-lastsuccessfullyexecutedcode="df['pronouns'] = df['review'].apply(assign_pronoun)" data-executioncancelledat="null" data-lastexecutedat="1719740203103" data-lastexecutedbykernel="9896dc8c-d55f-4b46-9684-fd55c8f98cab" data-lastscheduledrunid="null" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'pronouns'</span>] <span class="op">=</span> df[<span class="st">'review'</span>].<span class="bu">apply</span>(assign_pronoun)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d49203f7-3842-4d7e-a55c-53e7213faf7a" class="cell" data-executioncancelledat="null" data-executiontime="51" data-lastexecutedat="1719740204622" data-lastexecutedbykernel="9896dc8c-d55f-4b46-9684-fd55c8f98cab" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="df.pronouns.value_counts()" data-outputsmetadata="{&quot;0&quot;:{&quot;height&quot;:121,&quot;type&quot;:&quot;dataFrame&quot;}}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df.pronouns.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>M    417
F    139
Name: pronouns, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="c.-are-there-any-initial-differences-between-male-and-female-professors-based-on-their-overall-ratings" class="level3">
<h3 class="anchored" data-anchor-id="c.-are-there-any-initial-differences-between-male-and-female-professors-based-on-their-overall-ratings">3c. Are there any initial differences between male and female professors based on their overall ratings?</h3>
<p>Let‚Äôs start with a barplot.</p>
<div id="d839f267-6424-4f91-9753-6f14741947e8" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="508" data-lastsuccessfullyexecutedcode="plt.figure(figsize=(4,4)) sns.barplot(data=df, x=&quot;pronouns&quot;, y=&quot;rating&quot;, palette='magma',estimator='median') plt.show()" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">4</span>))sns.barplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">"pronouns"</span>, y<span class="op">=</span><span class="st">"rating"</span>, palette<span class="op">=</span><span class="st">'magma'</span>,estimator<span class="op">=</span><span class="st">'median'</span>)plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook-solution_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A boxplot overlaid with a stripplot will give us a better sense of the distribution of the data.</p>
<div id="171c79c8-f16b-43c7-9692-5123a609d72e" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="866" data-lastsuccessfullyexecutedcode="plt.figure(figsize=(5,5)) sns.boxplot(data=df, x=&quot;pronouns&quot;, y=&quot;rating&quot;, palette='magma') sns.stripplot(x='pronouns', y='rating', data=df, color='chartreuse',jitter=0.2, size=2.5) plt.show()" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">5</span>))sns.boxplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">"pronouns"</span>, y<span class="op">=</span><span class="st">"rating"</span>, palette<span class="op">=</span><span class="st">'magma'</span>)sns.stripplot(x<span class="op">=</span><span class="st">'pronouns'</span>, y<span class="op">=</span><span class="st">'rating'</span>, data<span class="op">=</span>df, color<span class="op">=</span><span class="st">'chartreuse'</span>,jitter<span class="op">=</span><span class="fl">0.2</span>, size<span class="op">=</span><span class="fl">2.5</span>)plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook-solution_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="task-3d.-what-are-the-most-important-words-being-used-to-describe-professors-in-reviews" class="level2">
<h2 class="anchored" data-anchor-id="task-3d.-what-are-the-most-important-words-being-used-to-describe-professors-in-reviews">Task 3d. What are the most important words being used to describe professors in reviews?</h2>
<p>Let‚Äôs write a custom function that <strong>tokenizes</strong> and <strong>lemmatizes</strong> our list of words.- <strong>Word tokenization</strong>: process of splitting text into individual words, called tokens. A common preprocessing step in natural language processing (NLP) so that text can be analyzed and processed more easily. Methods include whitespace tokenization, regular expression-based tokenization, and rule-based tokenization. We‚Äôll be using the <code>word_tokenize</code> tokenizer from <code>nltk</code>, with all its defaults.- <strong>Lemmatization</strong>: process of reducing words to their base or dictionary form, called the lemma. Also a common pre-processing step in NLP, so that words with a common base form are treated the same way. For example, the lemma of ‚Äúam‚Äù is ‚Äúbe‚Äù, of ‚Äúrunning‚Äù is ‚Äúrun‚Äù, and of ‚Äúmice‚Äù is ‚Äúmouse‚Äù.</p>
<div id="14af1c53-1fae-4673-b8a9-c80945fcf6b0" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="0" data-lastsuccessfullyexecutedcode="def tokenize(text):     tk = WhitespaceTokenizer()     tokens = tk.tokenize(text)     stems = []     for item in tokens:         stems.append(PorterStemmer().stem(item))     return stems     # return tokens" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenize(text):    tk <span class="op">=</span> WhitespaceTokenizer()    tokens <span class="op">=</span> tk.tokenize(text)    stems <span class="op">=</span> []    <span class="cf">for</span> item <span class="kw">in</span> tokens:        stems.append(PorterStemmer().stem(item))    <span class="cf">return</span> stems    <span class="co"># return tokens</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let‚Äôs import a list of stop words, which are common English words that we will be ignoring in our analysis. <code>sklearn</code> provides a common list of stop words, and we can append additional words to this list. Below, we append pronouns, along with the words ‚Äúclass‚Äù and ‚Äústudent‚Äù.</p>
<div id="17fee0ae-b095-4132-b09b-f06bf8dda71b" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="0" data-lastsuccessfullyexecutedcode="my_stop_words = text.ENGLISH_STOP_WORDS.union([&quot;he&quot;,&quot;she&quot;,&quot;his&quot;,&quot;her&quot;,                                               &quot;himself&quot;,&quot;herself&quot;, &quot;hers&quot;,&quot;shes&quot;                                               &quot;class&quot;,&quot;student&quot;])" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>my_stop_words <span class="op">=</span> text.ENGLISH_STOP_WORDS.union([<span class="st">"he"</span>,<span class="st">"she"</span>,<span class="st">"his"</span>,<span class="st">"her"</span>,                                              <span class="st">"himself"</span>,<span class="st">"herself"</span>, <span class="st">"hers"</span>,<span class="st">"shes"</span>                                              <span class="st">"class"</span>,<span class="st">"student"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the purpose of analyzing review texts, we want to move from having one row for each professor to one row for each review. Lets do this with <code>.explode()</code> from pandas.</p>
<div id="91f24d99-a96d-4a6b-8f19-b972aac0885f" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="742" data-lastsuccessfullyexecutedcode="df_quality = df[(df['review'].apply(len) == df['quality'].apply(len))] q = df_quality[['pronouns','review','quality']].explode(['review','quality'], ignore_index=True).dropna() q['quality'] = q['quality'].astype(float)" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_quality <span class="op">=</span> df[(df[<span class="st">'review'</span>].<span class="bu">apply</span>(<span class="bu">len</span>) <span class="op">==</span> df[<span class="st">'quality'</span>].<span class="bu">apply</span>(<span class="bu">len</span>))]q <span class="op">=</span> df_quality[[<span class="st">'pronouns'</span>,<span class="st">'review'</span>,<span class="st">'quality'</span>]].explode([<span class="st">'review'</span>,<span class="st">'quality'</span>], ignore_index<span class="op">=</span><span class="va">True</span>).dropna()q[<span class="st">'quality'</span>] <span class="op">=</span> q[<span class="st">'quality'</span>].astype(<span class="bu">float</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>TFIDF vectorization is the process of assigning scores to each review in a document based on how frequently the word occurs, normalized by how frequently the word occurs in the dataset overall.We‚Äôll use <code>TfidfVectorizer()</code> to generate these scores. This will return a matrix, with as many rows as reviews, and as many columns as words in our dataset.</p>
<div id="7ff1b94d-755e-4777-a149-57af7c806207" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="7653" data-lastsuccessfullyexecutedcode="vec = TfidfVectorizer(tokenizer=tokenize, stop_words=my_stop_words,                      ngram_range=(1,4)) X = vec.fit_transform(q['review']) feature_names = vec.get_feature_names_out()" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>vec <span class="op">=</span> TfidfVectorizer(tokenizer<span class="op">=</span>tokenize, stop_words<span class="op">=</span>my_stop_words,                     ngram_range<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">4</span>))X <span class="op">=</span> vec.fit_transform(q[<span class="st">'review'</span>])feature_names <span class="op">=</span> vec.get_feature_names_out()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>X</code> is a sparse matrix. We‚Äôll now move into filtering X for:- Male professors only- Female professors only- Rows with male professors and reviews of high quality - Rows with female professors and reviews of high quality - Rows with male professors and reviews of low quality - Rows with female professors and reviews of low quality We can explore feature importance in each of these to get a sense of which words and phrases are coming up most often in the data.</p>
<div id="28537a88-8a7e-42c4-ba8b-276532defc87" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="0" data-lastsuccessfullyexecutedcode="m_pos = X[(q['pronouns']=='M') &amp; (q['quality']>=4.5),:]  f_pos = X[(q['pronouns']=='F') &amp; (q['quality']>=4.5),:]  m_neg = X[(q['pronouns']=='M') &amp; (q['quality']<2.5),:]  f_neg = X[(q['pronouns']=='M') &amp; (q['quality']<2.5),:] " data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>m_pos <span class="op">=</span> X[(q[<span class="st">'pronouns'</span>]<span class="op">==</span><span class="st">'M'</span>) <span class="op">&amp;</span> (q[<span class="st">'quality'</span>]<span class="op">&gt;=</span><span class="fl">4.5</span>),:] f_pos <span class="op">=</span> X[(q[<span class="st">'pronouns'</span>]<span class="op">==</span><span class="st">'F'</span>) <span class="op">&amp;</span> (q[<span class="st">'quality'</span>]<span class="op">&gt;=</span><span class="fl">4.5</span>),:] m_neg <span class="op">=</span> X[(q[<span class="st">'pronouns'</span>]<span class="op">==</span><span class="st">'M'</span>) <span class="op">&amp;</span> (q[<span class="st">'quality'</span>]<span class="op">&lt;</span><span class="fl">2.5</span>),:] f_neg <span class="op">=</span> X[(q[<span class="st">'pronouns'</span>]<span class="op">==</span><span class="st">'M'</span>) <span class="op">&amp;</span> (q[<span class="st">'quality'</span>]<span class="op">&lt;</span><span class="fl">2.5</span>),:] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let‚Äôs have a look at what language students are using to describe male professors positively. The code below will return the 300 most important ngrams.</p>
<div id="0f03fbae-4024-4c85-b9a5-7924d06af553" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="34" data-lastsuccessfullyexecutedcode="importance = np.argsort(np.asarray(m_pos.sum(axis=0)).ravel())[::-1] tfidf_feature_names = np.array(feature_names) tfidf_feature_names[importance[:300]]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>importance <span class="op">=</span> np.argsort(np.asarray(m_pos.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)).ravel())[::<span class="op">-</span><span class="dv">1</span>]tfidf_feature_names <span class="op">=</span> np.array(feature_names)tfidf_feature_names[importance[:<span class="dv">300</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array(['comment', 'great', 'hi', 'veri', 'class', 'best', 'good',
       'professor', 'realli', 'teacher', "he'", 'wa', 'thi', 'make',
       'help', 'easi', 'love', 'prof', 'awesom', 'know', 'class.',
       'learn', 'lectur', 'amaz', 'cours', 'excel', 'just', 'test',
       'alway', 'prof.', 'lot', 'work', 'nice', 'ha', "i'v", 'teach',
       'teacher.', 'hi class', 'want', 'best professor', 'him.',
       'professor.', 'like', 'guy', 'class,', 'dr.', 'funni', 'hard',
       'need', 'read', 'know hi', 'fun', 'clear', 'materi', 'enjoy',
       'great teacher', 'recommend', 'studi', 'exam', 'care', 'note',
       'guy.', 'time', 'best prof', 'understand', 'best teacher',
       'teacher,', 'everi', 'definit', "don't", "you'll", 'it.', 'onli',
       'everyth', 'man', 'becaus', 'ani', 'fair', 'took', 'students.',
       'extrem', 'veri good', 'use', 'had.', 'knowledg', 'explain',
       'prof!', 'interesting.', 'well.', 'grade', 'veri help', 'question',
       'fantast', 'math', 'book', 'thi class', 'hi lectur', 'write',
       'highli', 'think', 'doe', 'attend', 'actual', 'professor,',
       'thing', 'pretti', 'stuff', 'assign', 'prof,', 'hi students.',
       'got', 'helpful.', 'befor', 'favorit', 'peopl', 'sure', 'him!',
       'way', 'care hi', "it'", 'long', 'talk', 'absolut', 'super',
       'guy,', '-', 'passion', 'littl', 'funny,', 'tough', 'hi class.',
       'cool', '&amp;', 'tri', 'professor!', 'great teacher,', 'wish', 'tell',
       'person', 'a.', 'good teacher', 'helpful,', 'final', 'make sure',
       'year', 'expect', 'difficult', 'make class', 'come', 'ask',
       'love thi', 'subject', 'everyon', 'teacher!', 'man.', 'hi test',
       'look', 'u', 'material.', 'answer', 'listen', 'sens', 'pay',
       'class wa', 'great prof.', 'paper', 'offic', 'great professor.',
       'wa veri', 'worth', 'say', 'far', 'histori', "you'r", 'hi stuff',
       'great teacher.', 'great prof!', 'know hi stuff', 'interesting,',
       'veri easi', 'easy.', 'bit', 'learn lot', 'veri nice', "doesn't",
       'veri clear', 'classes.', 'thought', "he' veri", 'best.', 'smart',
       'fine.', 'anyon', "i'v had.", 'realli enjoy', 'onlin', 'you.',
       'love hi', 'prepar', 'thi class.', 'stori', 'essay', 'exampl',
       'entertain', 'attent', 'better', 'course.', 'mani', '2',
       'homework', 'taken', 'engag', 'bad', 'great prof,', 'notes.',
       'textbook', 'truli', 'realli know', 'awesome.', 'real',
       'excel teacher.', "didn't", 'inform', 'miss', 'challeng', 'review',
       'old', 'class!', "professor i'v", 'thi guy', 'problem', 'let',
       'genuin', 'great!', 'too.', 'did', 'work.', 'topic', 'great guy.',
       "he'll", 'best!', 'enjoy hi', 'brilliant', 'veri knowledg',
       'concept', 'overal', 'bore', "i'm", 'dure', "teacher i'v",
       'alway help', 'approach', 'stuff.', 'feel', 'thi professor',
       'pay attent', 'intellig', 'mark', 'effort', 'midterm', 'great.',
       'extra', 'tests.', 'veri helpful.', 'instructor', 'text', 'reason',
       'hi stuff.', 'taught', 'quizz', 'goe', 'lab', 'end', 'teacher!!',
       'easy,', ':)', 'lot.', 'great professor', 'know hi stuff.',
       'probabl', 'grade.', 'quit', 'pass', 'exams.', 'fair.', 'kind',
       'hand', 'incred', 'avail', 'realli know hi', 'highli recommend',
       "can't", 'wonder', 'humor', 'lectures.', 'job', 'him,',
       'great prof', 'major', 'hour'], dtype=object)</code></pre>
</div>
</div>
<p>Let‚Äôs have a look at what language students are using to describe female professors positively. The code below will return the 300 most important ngrams.</p>
<div id="0042e940-af1c-4fce-9a35-2a6ef40088dc" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false,&quot;source_hidden&quot;:false}" data-executiontime="25" data-lastsuccessfullyexecutedcode="importance = np.argsort(np.asarray(f_pos.sum(axis=0)).ravel())[::-1] tfidf_feature_names = np.array(feature_names) tfidf_feature_names[importance[:300]]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>importance <span class="op">=</span> np.argsort(np.asarray(f_pos.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)).ravel())[::<span class="op">-</span><span class="dv">1</span>]tfidf_feature_names <span class="op">=</span> np.array(feature_names)tfidf_feature_names[importance[:<span class="dv">300</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array(['comment', 'veri', 'great', 'class', 'help', "she'", 'easi',
       'realli', 'best', 'wa', 'good', 'professor', 'thi', 'teacher',
       'make', 'love', 'lot', 'prof', 'class.', 'work', 'learn', 'prof.',
       'nice', 'lectur', 'cours', 'like', 'amaz', 'want', 'excel',
       'teacher.', 'care', 'know', 'her.', 'alway', 'ha', 'wonder',
       'just', 'extrem', 'hard', 'awesom', 'recommend', 'dr.', 'need',
       'test', 'fair', 'time', 'understand', 'professor.', "don't",
       'studi', 'best teacher', 'teach', 'her!', 'read', 'exam', 'grade',
       'assign', 'class,', 'veri help', 'highli', 'thing',
       'best professor', 'helpful.', 'materi', 'clear', 'interesting.',
       'super', "it'", "i'v", 'onlin', 'great.', 'awesome!', 'enjoy',
       'extra', 'sure', 'ani', 'thi class', 'definit', 'students.',
       'pretti', 'becaus', 'question', 'ladi', 'pay', 'everi', 'her,',
       'talk', 'mrs.', 'veri nice', 'actual', "you'll", 'work,',
       'passion', 'took', 'teacher!', 'veri good', 'homework',
       "she' veri", 'everyth', 'fun', 'class!', 'best prof', 'professor,',
       'well.', 'come', 'onli', 'better', '-', 'think', 'great prof.',
       'explain', 'wa veri', 'real', 'highli recommend', 'doe', 'tough',
       'wish', 'world', 'a.', 'excel prof', 'long', 'use', 'littl',
       'person', 'material.', 'attent', 'great teacher.', 'sweet',
       'veri easi', 'peopl', 'prof,', 'helpful,', 'credit', 'had.', '&amp;',
       'it.', 'anyth', 'great!', 'lab', 'knowledg', 'expect', 'prof!',
       'problem', 'write', 'professor!', 'teacher,', "you'r", 'approach',
       'look', 'math', 'pass', 'thi cours', 'pay attent', 'discuss',
       'note', 'you.', 'absolut', 'class wa', 'course.', 'mani', 'ever!',
       'befor', 'extra credit', 'sens', 'especi', 'taught', 'person.',
       'got', 'learn lot', 'help.', 'bit', 'work.',
       'best professor ever!', 'understand.', 'classes.', 'fair.',
       'lectures.', 'ask', 'great prof', 'nice,', 'grade.', 'tell',
       'year', 'lady.', 'professor ever!', 'point', 'thought', 'attend',
       'cool', 'quizz', 'make sure', 'way', 'veri helpful.', 'answer',
       'students,', 'fine.', "she'll", 'easi understand.', 'amazing.',
       'did', 'end', 'instructor', 'great teacher', 'project', 'challeng',
       'respect', 'offer', 'great professor!', 'entertain', 'essay',
       'good lectur', 'veri clear', 'favorit', 'difficult', 'english',
       'exampl', 'anyon', 'truli', 'great prof!', 'great teacher,', 'goe',
       'realli want', "i'm", 'nice lady.', 'intellig', 'classes!',
       'awsom', 'concept', 'veri helpful,', 'lot.', 'book', "doesn't",
       'group', 'lectures,', 'them.', 'listen', 'kind', 'smart', '3',
       'funni', "i'd", 'easy.', 'veri fair', 'great professor,', 'tri',
       "she' realli", 'make class', 'open', 'guid', 'recommend her.',
       'inspir', 'spanish', 'account', 'probabl', 'offic', 'easi grade!',
       'paper', 'school', 'woman', 'great prof,', 'great teacher!',
       'questions.', 'taken', 'help prof', 'real world', 'love her!',
       'stori', 'good professor.', 'let', "isn't", 'effort', "prof i'v",
       'worth', 'alot', 'avail', 'funny.', 'subject', 'book.', 'hour',
       'job', 'too.', 'yummer', 'best!!', '√£\x82√¢', 'knowledgable.',
       'research', 'say', 'clearli', 'engag', 'realli know', 'helpful!',
       'requir', 'prepar', 'demand', 'exams.', 'midterm', 'thank', 'far',
       'great professor.', 'easy,'], dtype=object)</code></pre>
</div>
</div>
<p>Let‚Äôs have a look at what language students are using to describe male professors negatively.</p>
<div id="bcc7dfc9-edab-4d8c-9a37-d02aa3549ec7" class="cell" data-executiontime="8" data-lastsuccessfullyexecutedcode="importance = np.argsort(np.asarray(m_neg.sum(axis=0)).ravel())[::-1] tfidf_feature_names = np.array(feature_names) tfidf_feature_names[importance[:300]]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>importance <span class="op">=</span> np.argsort(np.asarray(m_neg.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)).ravel())[::<span class="op">-</span><span class="dv">1</span>]tfidf_feature_names <span class="op">=</span> np.array(feature_names)tfidf_feature_names[importance[:<span class="dv">300</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>array(['comment', 'hi', 'thi', 'class', 'veri', 'wa', 'teach', 'worst',
       'test', 'lectur', "doesn't", 'class.', 'like', 'hard', 'just',
       "don't", 'professor', 'doe', 'know', 'grade', 'make', 'avoid',
       'bore', 'teacher', "he'", 'question', 'onli', 'terribl', 'good',
       'read', 'horribl', 'ha', 'learn', 'cours', 'prof', 'time', 'exam',
       'understand', 'thi class', 'talk', 'becaus', 'help', 'realli',
       'guy', 'him.', 'explain', 'bad', 'say', 'ask', 'ani', 'hi class',
       "can't", 'thing', 'think', "didn't", 'way', 'book', 'thi guy',
       'noth', 'need', 'materi', 'answer', 'wast', 'hi lectur', 'extrem',
       'work', 'everi', 'want', 'expect', 'nice', 'teacher.', 'class,',
       'assign', 'worst professor', 'all.', 'studi', 'professor.', 'did',
       'note', 'anyth', 'use', "i'v", 'difficult', 'final', 'unclear',
       'tell', 'drop', 'hi test', 'complet', 'worst prof', 'confus',
       'dont', 'man', 'tri', 'absolut', 'got', 'time.', 'everyth', '-',
       'easi', 'had.', 'rude', 'it.', 'write', 'fail', 'stay',
       'worst teacher', '3', 'point', 'math', 'hard.', 'class wa', 'lot',
       'mark', "it'", 'day', 'took', 'students.', 'clear', 'anoth',
       'homework', 'tests.', 'useless', 'recommend', 'awful.', 'peopl',
       'goe', 'littl', 'entir', 'unless', 'word', 'hi class.', 'someon',
       'actual', 'come', 'textbook', 'hour', 'boring.', 'thi professor',
       'lectures.', 'problem', 'dure', 'attend', 'better', 'half', 'went',
       'veri hard', 'aw', 'care', 'pass', 'doesnt', 'prepar', 'everyon',
       'person', 'paper', 'course.', 'ever.', 'look', '2', 'whi', 'mean',
       'feel', 'year', 'arrog', 'midterm', 'prof.', 'ask question',
       'thi class.', 'u', 'alway', "i'm", 'pretti', "you'r", 'hardest',
       'speak', 'hate', 'imposs', 'old', 'befor', '&amp;', 'end', 'thi cours',
       'poor', 'subject', 'semest', 'said', 'told', 'guy,', 'someth',
       'test.', 'basic', 'grade.', 'project', 'thi man', "isn't", 'mani',
       'onlin', 'rambl', 'listen', 'idea', 'sit', 'base', 'differ',
       'tough', 'incred', 'taught', 'essay', 'him,', 'away', 'hear',
       'major', 'you.', "won't", 'terrible.', 'school', 'total', 'random',
       'refus', 'concept', 'teach.', 'high', 'sure', 'exampl', 'slide',
       'probabl', "you'll", 'anything.', 'veri difficult', 'week',
       'hi teach', 'averag', 'questions.', 'follow', 'smart', 'save',
       "i'v had.", 'possibl', 'avoid thi', 'right', 'life', 'wrote',
       'far', 'boring,', 'bore lectur', 'topic', 'offic', 'knowledg',
       'long', 'present', 'costs.', 'hi note', 'dr.', "he'll",
       'answer question', 'believ', 'worth', 'pleas', "don't know", 'els',
       'lab', '10', 'wrong.', 'run', 'harder', 'material.', 'wast time.',
       'teacher,', "doesn't explain", 'let', 'nice guy', 'again.',
       'veri bore', 'definit', 'quizz', 'chang', 'email', 'teaching.',
       'them.', "can't teach", 'hi exam', 'minut', 'lecture.',
       'thi teacher', 'pick', 'veri unclear', 'taken', 'avoid costs.',
       'hard,', 'theori', 'book.', 'life.', "wasn't", 'suck', 'guy.',
       ':(', "worst professor i'v", 'text', 'prof ever.', '....', 'group'],
      dtype=object)</code></pre>
</div>
</div>
<p>Let‚Äôs have a look at what language students are using to describe female professors positively.</p>
<div id="a970b19e-371d-4e4e-b0e3-b1f4529c40bc" class="cell" data-executiontime="26" data-lastsuccessfullyexecutedcode="importance = np.argsort(np.asarray(f_neg.sum(axis=0)).ravel())[::-1] tfidf_feature_names = np.array(feature_names) tfidf_feature_names[importance[:300]]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>importance <span class="op">=</span> np.argsort(np.asarray(f_neg.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)).ravel())[::<span class="op">-</span><span class="dv">1</span>]tfidf_feature_names <span class="op">=</span> np.array(feature_names)tfidf_feature_names[importance[:<span class="dv">300</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array(['comment', 'hi', 'thi', 'class', 'veri', 'wa', 'teach', 'worst',
       'test', 'lectur', "doesn't", 'class.', 'like', 'hard', 'just',
       "don't", 'professor', 'doe', 'know', 'grade', 'make', 'avoid',
       'bore', 'teacher', "he'", 'question', 'onli', 'terribl', 'good',
       'read', 'horribl', 'ha', 'learn', 'cours', 'prof', 'time', 'exam',
       'understand', 'thi class', 'talk', 'becaus', 'help', 'realli',
       'guy', 'him.', 'explain', 'bad', 'say', 'ask', 'ani', 'hi class',
       "can't", 'thing', 'think', "didn't", 'way', 'book', 'thi guy',
       'noth', 'need', 'materi', 'answer', 'wast', 'hi lectur', 'extrem',
       'work', 'everi', 'want', 'expect', 'nice', 'teacher.', 'class,',
       'assign', 'worst professor', 'all.', 'studi', 'professor.', 'did',
       'note', 'anyth', 'use', "i'v", 'difficult', 'final', 'unclear',
       'tell', 'drop', 'hi test', 'complet', 'worst prof', 'confus',
       'dont', 'man', 'tri', 'absolut', 'got', 'time.', 'everyth', '-',
       'easi', 'had.', 'rude', 'it.', 'write', 'fail', 'stay',
       'worst teacher', '3', 'point', 'math', 'hard.', 'class wa', 'lot',
       'mark', "it'", 'day', 'took', 'students.', 'clear', 'anoth',
       'homework', 'tests.', 'useless', 'recommend', 'awful.', 'peopl',
       'goe', 'littl', 'entir', 'unless', 'word', 'hi class.', 'someon',
       'actual', 'come', 'textbook', 'hour', 'boring.', 'thi professor',
       'lectures.', 'problem', 'dure', 'attend', 'better', 'half', 'went',
       'veri hard', 'aw', 'care', 'pass', 'doesnt', 'prepar', 'everyon',
       'person', 'paper', 'course.', 'ever.', 'look', '2', 'whi', 'mean',
       'feel', 'year', 'arrog', 'midterm', 'prof.', 'ask question',
       'thi class.', 'u', 'alway', "i'm", 'pretti', "you'r", 'hardest',
       'speak', 'hate', 'imposs', 'old', 'befor', '&amp;', 'end', 'thi cours',
       'poor', 'subject', 'semest', 'said', 'told', 'guy,', 'someth',
       'test.', 'basic', 'grade.', 'project', 'thi man', "isn't", 'mani',
       'onlin', 'rambl', 'listen', 'idea', 'sit', 'base', 'differ',
       'tough', 'incred', 'taught', 'essay', 'him,', 'away', 'hear',
       'major', 'you.', "won't", 'terrible.', 'school', 'total', 'random',
       'refus', 'concept', 'teach.', 'high', 'sure', 'exampl', 'slide',
       'probabl', "you'll", 'anything.', 'veri difficult', 'week',
       'hi teach', 'averag', 'questions.', 'follow', 'smart', 'save',
       "i'v had.", 'possibl', 'avoid thi', 'right', 'life', 'wrote',
       'far', 'boring,', 'bore lectur', 'topic', 'offic', 'knowledg',
       'long', 'present', 'costs.', 'hi note', 'dr.', "he'll",
       'answer question', 'believ', 'worth', 'pleas', "don't know", 'els',
       'lab', '10', 'wrong.', 'run', 'harder', 'material.', 'wast time.',
       'teacher,', "doesn't explain", 'let', 'nice guy', 'again.',
       'veri bore', 'definit', 'quizz', 'chang', 'email', 'teaching.',
       'them.', "can't teach", 'hi exam', 'minut', 'lecture.',
       'thi teacher', 'pick', 'veri unclear', 'taken', 'avoid costs.',
       'hard,', 'theori', 'book.', 'life.', "wasn't", 'suck', 'guy.',
       ':(', "worst professor i'v", 'text', 'prof ever.', '....', 'group'],
      dtype=object)</code></pre>
</div>
</div>
</section>
<section id="congratulations-on-making-it-to-the-end-where-to-from-here--we-can-feed-these-words-into-ben-schmidts-tool-to-derive-insights-by-field.--if-youre-interested-in-learning-more-about-web-scraping-take-our-courses-on-web-scraping-in-python--if-youre-intersted-in-diving-in-to-the-world-of-natural-language-processing-explore-our-skill-track." class="level2">
<h2 class="anchored" data-anchor-id="congratulations-on-making-it-to-the-end-where-to-from-here--we-can-feed-these-words-into-ben-schmidts-tool-to-derive-insights-by-field.--if-youre-interested-in-learning-more-about-web-scraping-take-our-courses-on-web-scraping-in-python--if-youre-intersted-in-diving-in-to-the-world-of-natural-language-processing-explore-our-skill-track.">Congratulations on making it to the end! ### Where to from here?- We can feed these words into Ben Schmidt‚Äôs <a href="https://benschmidt.org/profGender/#%7B%22database%22%3A%22RMP%22%2C%22plotType%22%3A%22pointchart%22%2C%22method%22%3A%22return_json%22%2C%22search_limits%22%3A%7B%22word%22%3A%5B%22his%20kids%22%2C%22her%20kids%22%5D%2C%22department__id%22%3A%7B%22%24lte%22%3A25%7D%7D%2C%22aesthetic%22%3A%7B%22x%22%3A%22WordsPerMillion%22%2C%22y%22%3A%22department%22%2C%22color%22%3A%22gender%22%7D%2C%22counttype%22%3A%5B%22WordCount%22%2C%22TotalWords%22%5D%2C%22groups%22%3A%5B%22unigram%22%5D%2C%22testGroup%22%3A%22C%22%7D">tool</a> to derive insights by field.- If you‚Äôre interested in learning more about <a href="https://app.datacamp.com/learn/courses/web-scraping-with-python">web scraping</a>, take our courses on Web Scraping in Python- If you‚Äôre intersted in diving in to the world of Natural Language Processing, explore our <a href="https://app.datacamp.com/learn/skill-tracks/natural-language-processing-in-python">skill track</a>.</h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>